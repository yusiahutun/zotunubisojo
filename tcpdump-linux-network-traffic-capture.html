<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="ZenVlog"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="How to Capture Network Traffic in Linux With tcpdump"><meta property="og:title" content="How to Capture Network Traffic in Linux With tcpdump"><meta property="twitter:title" content="How to Capture Network Traffic in Linux With tcpdump"><meta name=description content="Linux comes equipped with a plethora of networking utilities to choose from. tcpdump is one such powerful networking tool that can capture and analyze network traffic should you need to troubleshoot network errors on Linux."><meta property="og:description" content="Linux comes equipped with a plethora of networking utilities to choose from. tcpdump is one such powerful networking tool that can capture and analyze network traffic should you need to troubleshoot network errors on Linux."><meta property="twitter:description" content="Linux comes equipped with a plethora of networking utilities to choose from. tcpdump is one such powerful networking tool that can capture and analyze network traffic should you need to troubleshoot network errors on Linux."><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>How to Capture Network Traffic in Linux With tcpdump |</title><link rel=canonical href=./tcpdump-linux-network-traffic-capture.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>ZenVlog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/blog>blog</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>How to Capture Network Traffic in Linux With tcpdump</h1><h2 class=subheading></h2><span class=meta>Posted by
Martina Birk
on
Saturday, May 11, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><p>Linux comes equipped with a plethora of networking utilities to choose from. tcpdump is one such powerful networking tool that can capture and analyze network traffic should you need to troubleshoot network errors on Linux.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Let's get hands-on with the tcpdump command and explore how to use it to capture network traffic.</p><h2 id=installing-tcpdump-in-linux>Installing tcpdump in Linux</h2><p>tcpdump usually comes pre-installed with <a href=#>all mainstream Linux distributions</a> and security-based alternatives. So you should be able to use it right away by typing in <strong>tcpdump</strong> with a <strong>sudo</strong> prefix.</p><p>In case you are unable to run the tcpdump command and are stuck at the "<strong>tcpdump: command not found</strong>" error, let's learn how to install tcpdump on your Linux machine.</p><p>To install tcpdump, fire up the terminal and run the command corresponding to the Linux distro that you're currently using:</p><p>On Debian/Ubuntu derivatives, run:</p><pre><code class="hljs javascript">sudo apt-<span class=hljs-keyword>get</span> install tcpdump</code> </pre><p>On <a href=#>Arch-based systems</a>, run:</p><pre><code class="hljs xml">sudo pacman -S tcpdump<br></code> </pre><p>To install the tcpdump utility on Fedora, CentOS, and RHEL, issue the following command:</p><pre><code class="hljs sql">sudo dnf <span class=hljs-keyword>install</span> tcpdump</code> </pre><p>Note that if you're asked to install <strong>libcap</strong>, type in <strong>Yes</strong> or <strong>Y</strong> as it is a core dependency, without which tcpdump will refuse to start up. This should install the tcpdump utility and solve the "command not found" error.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Now that tcpdump has been installed on your system, let's explore the different options and functionalities it offers.</p><h2 id=capturing-network-traffic-with-tcpdump>Capturing Network Traffic With tcpdump</h2><p>tcpdump offers a lot of flags to modify its execution but it can be run as a standalone command as well. However, running tcpdump without any flags or arguments would be neglecting its full potential. It's always better to use a few flags to tweak the execution and output as necessary.</p><p>Type in this command to monitor network transmissions with tcpdump:</p><pre><code class=hljs>sudo tcpdump</code> </pre><p>Now tcpdump will start to automatically capture network packets until <a href=#>an interrupt signal</a> is sent with <strong>Ctrl + Z</strong> to break the process manually. To limit the total number of packets captured, use the <strong>-c</strong> flag and type in the desired limit of packets next to it:</p><pre><code class=hljs>sudo tcpdump -c 5</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/sniffing-network-traffic-with-tcpdump.jpg> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>If you can't make sense of the output right now, you need to <a href=#>get familiar with the tcpdump output format</a> first.</p><h2 id=check-available-network-interfaces-with-tcpdump>Check Available Network Interfaces With tcpdump</h2><p>By default, tcpdump captures traffic from any of the available network interfaces. If you have multiple active network interfaces in use, you might want to define the network interface from which tcpdump should capture packets. To start tcpdump on a specific interface, you will have to first learn about the interface name.</p><p>Here's how to list all available network interfaces with tcpdump:</p><pre><code class=hljs>sudo tcpdump -D</code> </pre><p>Or, you can add the <strong>--list-interfaces</strong> flag to the command:</p><pre><code class="hljs php">sudo tcpdump --<span class=hljs-keyword>list</span>-interfaces</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/checking-available-network-interfaces-with-tcpdump.jpg> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>The output returned contains a list of all the active network interfaces that tcpdump can listen to. To configure tcpdump to capture transmissions from a particular network interface, type in this command:</p><pre><code class=hljs>sudo tcpdump -i interface_id</code> </pre><p>Or, you can add the <strong>--interface</strong> flag to the command:</p><pre><code class="hljs php">sudo tcpdump --<span class=hljs-class><span class=hljs-keyword>interface</span>&nbsp;<span class=hljs-title>interface_id</span></span></code> </pre><p>Now that we have captured a few packets, let's study them closely and learn how you can tweak the output to be more readable.</p><h2 id=exploring-tcpdump-filters>Exploring tcpdump Filters</h2><p>tcpdump is capable of capturing an overwhelming amount of traffic in a single run. Such information overload can throw you off track when investigating or troubleshooting issues with a specific host or network protocol.</p><p>Here's where the tcpdump filters come into play. You can append the tcpdump command with certain flags to filter out the network traffic and capture specific packets. You can then store those packets and later analyze them to get to the root of any network-related problems. Let's learn how to use filters in tcpdump.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h3 id=filter-packets-based-on-the-network-protocol-in-use>Filter Packets Based on the Network Protocol in Use</h3><p>To filter packets transmitted via a specific protocol, type in the protocol name with the tcpdump command, and it will only capture packets traveling via the defined network protocol.</p><p>For example, to capture ICMP-based packets, you would simply attach <strong>icmp</strong> at the end of the tcpdump command. The process is the same if you wish to capture only UDP or TCP packets.</p><pre><code class=hljs>sudo tcpdump -c 5 icmp</code> </pre><p>This command will only return output if there is an exchange of data through the ICMP protocol.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/filtering-traffic-on-the-basis-of-network-protocol.jpg><h3 id=filter-packets-based-on-the-host>Filter Packets Based on the Host</h3><p>You can configure tcpdump to capture packets related to a single host with the <strong>host</strong> parameter. This is especially useful when all the systems of your network are functioning except for one. This filter lets you perform targeted investigation and speeds up the overall troubleshooting workflow since you aren't distracted by unnecessary data.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>To capture packets related to a specific host, define the host's network address with the <strong>host</strong> parameter:</p><pre><code class="hljs css"><span class=hljs-selector-tag>sudo</span>&nbsp;<span class=hljs-selector-tag>tcpdump</span>&nbsp;<span class=hljs-selector-tag>-c</span> 5 <span class=hljs-selector-tag>host</span> 192<span class=hljs-selector-class>.168</span><span class=hljs-selector-class>.2</span><span class=hljs-selector-class>.1</span></code> </pre><p>Similar to the network protocol filter, this command will only return output if any ongoing transmission is related to the defined host.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/filtering-traffic-on-the-basis-of-host.jpg><h3 id=filter-packets-based-on-the-active-port>Filter Packets Based on the Active Port</h3><p>tcpdump is equipped with a parameter that lets you filter network traffic and capture only packets that are transmitted to or from a specific port.</p><p>To capture packets coming from a specific port, append the <strong>port</strong> flag to the tcpdump command and define the port number next to it. For instance, to capture any incoming or outgoing HTTP traffic, define port 80:</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre><code class="hljs xml">sudo tcpdump -c 5 port 80<br></code> </pre><p>tcpdump will listen on port 80, waiting for HTTP transmissions. Once it detects HTTP packets in the network, it will capture them.</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/filtering-traffic-on-the-basis-of-port.jpg><h3 id=combine-filters-together-for-advanced-sorting>Combine Filters Together for Advanced Sorting</h3><p>Previous sections discussed how you can filter traffic based on port, protocol, or host, but what if you wanted to capture traffic from a single port of a specific host using a particular network protocol? Well, you're in luck because this is possible, attributing to the ability to use logical operators with the tcpdump command.</p><p>To capture packets from an individual host using port 443, use this command:</p><pre><code class="hljs css"><span class=hljs-selector-tag>sudo</span>&nbsp;<span class=hljs-selector-tag>tcpdump</span>&nbsp;<span class=hljs-selector-tag>-c</span> 5 <span class=hljs-selector-tag>host</span> 192<span class=hljs-selector-class>.168</span><span class=hljs-selector-class>.2</span><span class=hljs-selector-class>.1</span>&nbsp;<span class=hljs-selector-tag>and</span>&nbsp;<span class=hljs-selector-tag>port</span> 443<br></code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/filtering-traffic-by-combining-parameters.jpg> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=inspect-the-contents-of-captured-packets>Inspect the Contents of Captured Packets</h2><p>By default, tcpdump displays the headers of a packet in the output. While it is more than enough in most cases, sometimes, you might want to or need to look deeper into the captured data. You can pass certain parameters with the tcpdump command to inspect the content of the captured package.</p><p>Here's how to view the content of the packets:</p><pre><code class=hljs>sudo tcpdump -c 5 -x</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/inspecting-packet-content-with--x-flag.jpg><p>This command returns the hex version of the content in a captured packet. If you wish to view the ASCII form of the data, you can pass the <strong>-A</strong> parameter with:</p><pre><code class=hljs>sudo tcpdump -A</code> </pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.makeuseofimages.com/wordpress/wp-content/uploads/2022/06/inspecting-packet-content-with--A-flag.jpg> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=save-tcpdump-output-to-a-file>Save tcpdump Output to a File</h2><p>Like almost any other Linux command-line tool, you can store the output produced by tcpdump into a file to be referenced later.</p><p>This can be done by adding the <strong>-w</strong> flag to the command. Upon execution, tcpdump will store the captured data into a <strong>.pcap</strong> file that can be later analyzed with tcpdump or other network monitoring tools like Wireshark.</p><p>Type in this command to store your tcpdump command's output into a file:</p><pre><code class="hljs css"><span class=hljs-selector-tag>sudo</span>&nbsp;<span class=hljs-selector-tag>tcpdump</span>&nbsp;<span class=hljs-selector-tag>-w</span>&nbsp;<span class=hljs-selector-tag>capture</span><span class=hljs-selector-class>.pcap</span></code> </pre><p>To read a <strong>.pcap</strong> file, you can use tcpdump with the <strong>-r</strong> parameter:</p><pre><code class="hljs css"><span class=hljs-selector-tag>sudo</span>&nbsp;<span class=hljs-selector-tag>tcpdump</span>&nbsp;<span class=hljs-selector-tag>-r</span>&nbsp;<span class=hljs-selector-tag>capture</span><span class=hljs-selector-class>.pcap</span></code> </pre><h2 id=the-best-networking-tools-for-linux>The Best Networking Tools for Linux</h2><p>Linux ships with a plethora of networking tools that can solve every network issue as long as it's on the software side of things. Knowing how to use a few of the best networking tools in Linux will definitely come in handy, whether you're a sysadmin managing networks for a living or just an everyday Linux user.</p><p>Since the actual list of available networking commands can be too much to fathom, here's a list of some of the most important Linux networking tools that you should know.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7rq3KnqysnZ%2Bbe6S7zGirnKiUqrqxecuipa6wXaOytcPOq6JmrKKWs6e1wmaamqikqr%2Bmew%3D%3D</p><hr><ul class=pager><li class=previous><a href=./lisa-vanderpump-lala-kent-sizzle-attend-vanderpump-dog-foundation-gala-html.html data-toggle=tooltip data-placement=top title="Lisa Vanderpump and Lala Kent sizzle as they attend the Vanderpump Dog Foundation Gala">&larr;
Previous Post</a></li><li class=next><a href=./harrison-chelsea-sho.html data-toggle=tooltip data-placement=top title="George's wife creating garden tribute for the green-fingered Beatle">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; ZenVlog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>